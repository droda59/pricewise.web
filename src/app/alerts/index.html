<template>
    <require from="./components/list-menu"></require>
    <require from="./components/create-list-modal"></require>
    <require from="./components/alerts-list"></require>
    <require from="../shared/components/add-source-modal"></require>
    <require from="../shared/components/header-title"></require>
    <require from="../shared/components/actions-menu.html"></require>
    <require from="../shared/components/actions-menu-action.html"></require>

    <div class="primary-dark" style="color: white;">
        <div class="ui container" style="position: relative;">
            <div class="ui text menu" style="margin: 0; padding: 3em 0;">
                <div class="item">
                    <header-title text="alerts.watchedProducts"></h1>
                </div>
            </div>
        </div>
    </div>

    <div class="primary-light" style="padding-bottom: 2em;">
        <div class="ui container">
            <list-menu
                lists.one-way="lists"
                selected-list.two-way="currentListFilter"
                delete.call="deleteList(list)"
                share.call="shareList(list)">
            </list-menu>

            <alerts-list
                show.bind="allAlerts.length"
                alerts.one-way="alerts"
                selected-alerts.two-way="selectedAlerts"
                add.call="showModal(createAlertModal)"
                activate.call="activateAlert(alert)">
            </alerts-list>

            <actions-menu show.bind="selectedAlerts.length">
                <actions-menu-action text="alerts.actions.clearSelection" icon="remove" action.call="clearSelection()"></actions-menu-action>
                <actions-menu-action text="alerts.actions.createList" icon="list" action.call="showModal(createListModal)" hide.bind="currentList"
                    analytics-category="List"
                    analytics-action="create"></actions-menu-action>
                <div class="ui dropdown link item" hide.bind="currentList">
                    <i class="outdent icon"></i>
                    ${'alerts.actions.addToList' | t}
                    <div class="menu">
                        <a repeat.for="list of lists | sort:'name'" class="item" click.delegate="addToList(selectedAlerts, list)"
                            data-analytics-category="List"
                            data-analytics-action="add"
                            data-analytics-label="footer">${list.name}</a>
                    </div>
                </div>
                <actions-menu-action text="alerts.actions.removeFromList" icon="indent" action.call="removeFromList(selectedAlerts)" show.bind="currentList"
                    analytics-category="List"
                    analytics-action="remove"></actions-menu-action>
                <actions-menu-action text="alerts.actions.deleteAlert" icon="indent" action.call="confirmDeleteAlert(selectedAlerts)" show.bind="currentList"
                    analytics-category="List"
                    analytics-action="delete"></actions-menu-action>
            </actions-menu>
        </div>

        <div class="ui overlay" hide.bind="allAlerts.length">
            <div style="width: 100%; position: absolute; top: 50%; left: 0;">
                <p style="text-align: center;" i18n="alerts.noAlert">You are not watching any products right now.</p>
                <p style="text-align: center;" i18n="alerts.getStarted">Get started!</p>
                <div style="text-align: center;">
                    <div class="ui primary primary-action button" click.delegate="showModal(addSourceModal)"
                        i18n="[append]alerts.createAlert"
                        data-analytics-category="Alerts"
                        data-analytics-action="add"
                        data-analytics-label="overlay">
                        <i class="plus icon"></i>
                    </div>
                </div>
            </div>
        </div>

        <loader text="alerts.updating" is-active.one-way="isUpdating"></loader>
        <create-list-modal view-model.ref="createListModal" is-working.one-way="isUpdating" alerts.one-way="selectedAlerts" save.call="saveList(list)"></create-list-modal>
        <add-source-modal view-model.ref="createAlertModal" is-working.one-way="isUpdating" add.call="createAlert(newAlertUrl)"></add-source-modal>
        <confirmation-modal view-model.ref="confirmationModal" message="alerts.deleteConfirmation"></confirmation-modal>
    </div>
</template>
