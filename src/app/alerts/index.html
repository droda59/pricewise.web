<template>
    <require from="./components/list-menu"></require>
    <require from="./components/create-list-modal"></require>
    <require from="./components/alerts-list"></require>
    <require from="../shared/components/add-source-modal"></require>
    <require from="../shared/components/header-title"></require>

    <div class="primary-dark" style="color: white;">
        <div class="ui container" style="position: relative;">
            <div class="ui text menu" style="margin: 0; padding: 3em 0;">
                <div class="item">
                    <header-title text="alerts.watchedProducts"></h1>
                </div>
            </div>
        </div>
    </div>

    <div class="primary-light" style="padding-bottom: 2em;">
        <div class="ui container">
            <list-menu class="mobile hidden"
                lists.one-way="lists"
                selected-list.two-way="currentListFilter"
                delete.call="deleteList(list)">
            </list-menu>

            <alerts-list
                show.bind="allAlerts.length"
                alerts.one-way="alerts"
                selected-alerts.two-way="selectedAlerts"
                add.call="showModal(createAlertModal)"
                activate.call="activateAlert(alert)">
            </alerts-list>

            <div class="ui bottom fixed labeled icon borderless secondary inverted primary-dark menu" style="justify-content: center;" show.bind="selectedAlerts.length">
                <a class="item" click.delegate="clearSelection()" style="font-size: 0.8em;" i18n="[append]alerts.actions.clearSelection">
                    <i class="remove icon"></i>
                </a>
                <a class="item" show.bind="!currentList" click.delegate="showModal(createListModal)" style="font-size: 0.8em;" i18n="[append]alerts.actions.createList"
                    data-analytics-category="List"
                    data-analytics-action="create"
                    data-analytics-label="footer">
                    <i class="list icon"></i>
                </a>
                <div class="ui dropdown link item" show.bind="!currentList" style="font-size: 0.8em;"
                    data-analytics-category="List"
                    data-analytics-action="add"
                    data-analytics-label="footer">
                    <i class="outdent icon"></i>
                    <div class="text" i18n="alerts.actions.addToList">Add to list</div>
                    <div class="menu">
                        <div repeat.for="list of lists | sort:'name'" class="item" click.delegate="addToList(selectedAlerts, list)">${list.name}</div>
                    </div>
                </div>
                <a class="item" show.bind="currentList" click.delegate="removeFromList(selectedAlerts)" style="font-size: 0.8em;" i18n="[append]alerts.actions.removeFromList"
                    data-analytics-category="List"
                    data-analytics-action="remove"
                    data-analytics-label="footer">
                    <i class="indent icon"></i>
                </a>
                <a class="item" click.delegate="confirmDeleteAlert(selectedAlerts)" style="font-size: 0.8em;" i18n="[append]alerts.actions.deleteAlert"
                    data-analytics-category="Alerts"
                    data-analytics-action="delete"
                    data-analytics-label="footer">
                    <i class="archive icon"></i>
                </a>
            </div>
        </div>

        <div class="ui overlay" hide.bind="allAlerts.length">
            <div style="width: 100%; position: absolute; top: 50%; left: 0;">
                <p style="text-align: center;" i18n="alerts.noAlert">You are not watching any products right now.</p>
                <p style="text-align: center;" i18n="alerts.getStarted">Get started!</p>
                <div style="text-align: center;">
                    <div class="ui primary primary-action button" click.delegate="showModal(addSourceModal)"
                        i18n="[append]alerts.createAlert"
                        data-analytics-category="Alerts"
                        data-analytics-action="add"
                        data-analytics-label="overlay">
                        <i class="plus icon"></i>
                    </div>
                </div>
            </div>
        </div>

        <loader text="alerts.updating" is-active.one-way="isUpdating"></loader>
        <create-list-modal view-model.ref="createListModal" is-working.one-way="isUpdating" alerts.one-way="selectedAlerts" save.call="saveList(list)"></create-list-modal>
        <add-source-modal view-model.ref="createAlertModal" is-working.one-way="isUpdating" add.call="createAlert(newAlertUrl)"></add-source-modal>
        <confirmation-modal view-model.ref="confirmationModal" message="alerts.deleteConfirmation"></confirmation-modal>
    </div>
</template>
